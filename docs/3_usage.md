---
sort: 3
permalink: /usage
---

# Usage

## File formats

RECOMBULATOR-X uses the PED files based on [PLINK](https://www.cog-genomics.org/plink/) pedigree files as input. The PED file format stores sample pedigree information (i.e., the familial relationships between samples) and the genotypes.
In particular, the first 6 mandatory columns contain: 

* Family ID
* Individual ID
* Paternal ID
* Maternal ID
* Sex
* Phenotype

The "Sex" field may be coded as: 1=male/2=female; XY=male/XX=female; M=male/F=female; MALE=male/FEMALE=female. If you are using STR markers, you can store within this column the Amelogenin marker. 

The "Phenotype" field refers to the use of PED files in medical research. In non-medical application, it may be -9 which means "unknown".  ATTENZIONE PERCHE' NELLA TABELLA E' -1
        
From the 7th column on, there are the markers genotypes (two columns for a genetic marker, each of the two storing an allele). In case of STRs, the columns contain  numbers, which correspond to the STR repeats or "0" when missing. 

:warning: **Genetic markers (from the 7th column on) must be provided according to their physical genomic position. Indeed, the algorithm will infer the recombination rate between A1 and A2, A2 and A3 and so on.** 

### Example

Here is a family (each row is an individual):

| **FID** |   **IID**   |   **PAT**   | **MAT** | **SEX** | **PHENO** | **STR-A1** | **STR-A2** | **STR-A1** | **STR-A2** | **STR-A1** | **STR-A2** |
|:-------:|:-----------:|:-----------:|:-------:|:-------:|:---------:|:----------:|:----------:|:----------:|:----------:|:----------:|:----------:|
| FAM_I | GRANDFATHER | 0           | 0       | 1       | -1        | 12         | 0          | 29         | 0          | 39         | 0          |
| FAM_I | MOTHER      | GRANDFATHER | 0       | 2       | -1        | 12         | 16         | 27         | 29         | 34         | 39         |
| FAM_I | SON_1       | 0           | MOTHER  | 1       | -1        | 12         | 0          | 29         | 0          | 34         | 0          |
| FAM_I | FATHER_1    | 0           | 0       | 1       | -1        | 14         | 0          | 21         | 0          | 37         | 0          |
| FAM_I | DAUGHTER_1  | FATHER_1    | MOTHER  | 2       | -1        | 14         | 16         | 21         | 27         | 34         | 37         |
| FAM_I | FATHER_2    | 0           | 0       | 1       | -1        | 18         | 0          | 25         | 0          | 36         | 0          |
| FAM_I | DAUGHTER_2  | FATHER_2    | MOTHER  | 2       | -1        | 12         | 18         | 25         | 29         | 36         | 39         |

---

## Tools

lista delle cose che fa con i link in un'altra pagina

## Python module

The Jupyter Notebook Estimation Example.ipynb in GitHub reports a detailed guide for the Python module usage. 

The estimation of recombination and mutation rates can be launched with the following line:

```Pyhton
est_recomb_rates, est_mut_rates = estimate_rates(processed_families, 0.1, 0.1, estimate_mutation_rates='all')
```

The function *estimate_rates* estimates recombination and mutation rates from a set of families and takes the following parameters: the families, the initial recombination rate, the initial mutation rate, which mutation rate needs to be estimated (*no*: no mutation rate estimation, *one*: just one mutation rate for all markers, *all*: a mutation rate for each marker), the type of implementation (the default implementation is the one using dynamic programming).

An example of output generated by function \emph{estimate_rates} in Python is: 

```    
(array([0.03874299, 0.32869992, 0.01459788, 0.19265765, 0.01016452]),
 array([1.00000000e-08, 1.00000000e-08, 1.23511804e-01, 2.10614659e-02, 2.24679981e-03, 1.00000000e-08]))
```
       
where, the first array (n-1 long) stores the recombination rates, while the second (n long) contains the mutation rates estimated for simulated families and six X-STRs.

## Command line tool

The basic usage of the RECOMBULATOR-X command line interface consists in estimating just recombination rate and using the default single value for mutation rate (0.001).

```Bash
xstr_recomb ped_path
``` 

Alternatively, one may also decide to estimate mutation rates. In particular, adding \emph{--estimate-mutation-rates all}, the tool will compute a mutation value for each marker. 

```Bash
xstr_recomb ped_path --estimate-mutation-rates all
```

The output of RECOMBULATOR-X command line interface is returned in a tabular format according to the options *no*, *one*, *all* for the parameter `--estimate-mutation-rates`. In particual, the recombination rates are computed between markers following the order in which they were provided in the PED file.

AGGIUNGERE TABELLE OUTPUT

AGGIUNGERE LINK ALLE FUNZIONI

AGGIUNGERE DESCRIZIONE DI COSA FA IL TOOL NELLA SEZIONE TOOLS



 



